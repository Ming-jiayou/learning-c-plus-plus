# 使用 Visual Studio Code 编写 Qt 应用程序

软件开发人员喜欢工具，特别是那些能让他们更高效的工具。所以在这篇博客文章中，我将分享我们KDAB的一些同事在使用Visual Studio Code进行Qt开发的经验。

## 使用Visual Studio Code而不是Qt Creator的动机

你可能会问的第一个问题大概就是：“既然我们已经有Qt Creator这个非常好用且特别针对Qt开发的IDE了，为什么还要考虑使用其他的编辑器或IDE呢？”当然，这是一个非常合理的问题。

对我来说，主要原因是Visual Studio Code在某些方面确实比Qt Creator做得更好——当然也有不如的地方，这我会在后面讨论。此外，我主要在macOS上进行开发，而Qt Creator在macOS上的稳定性并不总是像在Linux和Windows上那样可靠。我并不是主张完全抛弃Qt Creator。我目前的开发环境就是两者同时使用。

我配置了自动保存和自动重新加载功能，这样我可以在两者之间无缝切换。有些事情我在Qt Creator中完成，而其他事情则在Visual Studio Code中完成。当我切换焦点时，我的更改已经存在（或者我只需要在重新加载确认对话框中点击“全部确认”按钮），从而获得了两者的最佳体验。

在进入更详细的介绍之前，我想先解释一下关于Visual Studio Code的一些内容。在座的各位很可能对Microsoft Visual Studio有所了解。如果不了解，这里有一个简要概述。

Microsoft Visual Studio是微软推出的一款功能强大且全面的IDE/编译器/调试器套件，主要用于C#和C++开发，已经存在多年，并且可以在Windows和macOS上使用（但不支持Linux）。而令人困惑的是：Visual Studio Code与Microsoft Visual Studio几乎没有太大关系。（不过，我猜它们在底层代码方面可能有很多共通之处。）

Visual Studio Code 是微软自主研发的、开源且非商业化的编辑器（至少目前如此），基于 Electron 技术构建。与其他基于 Electron 的开发工具不同，Visual Studio Code 并未使用 Atom 编辑器组件，而是采用了一个独立的编辑器组件，该组件亦被用于微软的 Azure DevOps 产品中。当然，您在使用 Code 时无需关心或了解这些细节。

Visual Studio Code（简称 Code）可在此免费[下载](https://code.visualstudio.com)。

## Visual Studio Code 扩展

你很快就会发现，代码世界中存在着数量惊人的扩展。很多时候，当你问自己：“代码能做X吗？”答案通常是：“默认情况下不行，但通过扩展，完全可以实现。”

可用扩展的数量非常庞大（所有扩展都是免费的，尽管其中一些开发者要求进行小额且通常值得的捐赠），有时可能会让人感到困惑，尤其是当有多个扩展看起来服务于相同目的时。不过，有一个评分系统可以帮助你做出选择。 每当我感到不确定时，我会快速尝试几个扩展。许多扩展都有非常小且明确的用途，因此你可以很快确定某个特定的扩展是否符合你的需求。所有扩展都可以在不离开Code的情况下安装。

事实上，对于我的特定需求，使用Qt/C++进行开发，默认情况下并不支持。Code的根源是“偏向网络”的，主要支持JavaScript相关的语言，如TypeScript。尽管如此，安装由微软自己开发的C/C++扩展后，基本上能够满足C++开发的大部分需求。

## VS Code or Qt Creator?

所以，这么说来，使用VS Code和Qt Creator各自的优缺点是什么？

首先，目前来说，Code 对 Qt 本身一无所知。它不知道信号和槽、.ui 或 .ts 文件，也不知道 QML 或 Qt Designer。仅这一点就足以让人不选择完全切换到 Code。任何与 Qt 非常相关的事情在 Qt Creator 中处理会更好。完全有可能在未来某一天，有人会为 Code 编写一个 Qt 扩展（谁知道呢，说不定是个 KDAB 的人？），但据我所知，目前这样的扩展还不存在。

虽然代码不认识 Qt 或 QML，为什么还要用它来进行基于 Qt 的开发呢？因为在基于 Qt 的项目中，程序员的工作并非都是 Qt 专属的。举个例子，代码的全局查找和替换功能远胜于 Qt Creator。

在KDAB，我们经常与非常大的客户代码库合作，这些代码库通常历史悠久，而且往往无法联系到原始开发者，因此熟悉这些代码库是我们的工作关键。Code 工具可以非常精细地搜索符号，并且提供了大量控制来进行替换（按文件夹、按文件、按单个更改进行替换，每次潜在更改都有完整的语法着色差异等）。我经常发现自己从 Creator 切换到 Code 只是为了进行搜索（有时是替换），然后再切换回去。

**管理 Visual Studio Code 项目**

Qt Creator 和其他大多数集成开发环境一样，是基于项目的。你可以打开一个或多个项目，它会根据构建文件（QMake 的 .pro 文件或 CMake 的 CMakeLists.txt）加载项目中所有文件的信息。这样做的好处是，你不会遗漏任何东西，因为所有需要构建的内容都会被 Qt Creator 打开并读取。

另一方面，Visual Studio Code 是基于文件夹工作的。你一次只能打开一个文件夹（并且可以将多个文件夹组合成所谓的“工作区”一起打开），因此你可以进行更细粒度的控制。然而，很容易忽略位于单独文件夹中的文件。如前所述，我们在 KDAB 经常处理的代码库非常庞大（几百万行代码并不罕见），有时只打开其中的一部分会更方便，因为打开数百个文件可能会拖慢最好的 IDE。

**代码补全**

代码补全：智能代码补全确实让开发者的生活变得更加轻松，因此它成为任何IDE中最重要的一项功能。事实上，我认为在这方面两者不分伯仲。微软已经将广受好评的Intellisense代码补全功能从庞大的Visual Studio产品中“捐赠”给了Visual Studio Code，而Qt Creator的代码补全功能也相当出色且方便。两者在使用方式上相似度较高，因此在两者之间频繁切换并不会感到太困惑。不过，设置Intellisense有时可能会有些麻烦，尤其是在使用CLang时，但好在有详细的文档可以提供帮助。

## VSC 集成

另一个Code的优势在于它对版本控制系统有着非常广泛的支持（说白了，如今基本上就是指git）。Qt Creator确实有着全面的git支持，但我发现它并不是很易用。特别是，它与实际编写代码的操作并没有很好地集成。

在Code中，我可以轻松地在小注释中看到谁修改了某行代码以及修改的时间，这些注释采用低调的颜色显示。当你不需要时，它们很容易被忽略，但当你需要时，它们可以立即呈现；这比单独运行git log或git blame命令要高效得多（这个功能通过GitLens扩展实现）。即使是其他开发工具也得到了很好的集成；例如，如果你的组织正在使用Atlassian的Jira问题跟踪系统，就像我们KDAB这里一样，有一个方便且全面的扩展可以满足这一需求。

## CMake

最后，关于CMake的几句话。随着最近决定将CMake作为Qt项目默认构建工具的决策，这种情况可能会改变，但目前来看，CMake在Qt Creator中并不是第一优先级的工具，Qt Creator很大程度上是围绕QMake构建的。

你当然可以使用Qt Creator的优秀项目脚手架并告诉它使用CMake，但如果你添加新的文件或类，你需要手动将它们添加到CMakeLists.txt文件中，这需要通过CMake扩展来完成，这在一定程度上提供了更多的支持，至少在目前是这样。至于Qt 6发布后Qt Creator中对CMake的支持会有多大，还有待观察。

## 摘要

总之，我们建议关心生产力的Qt开发者尝试使用Visual Studio Code。它在可预见的未来（甚至可能永远）不会取代Qt Creator，但它绝对是一个有助于你更快、更好地编写代码的工具。

## 来源

翻译自https://www.kdab.com/using-visual-studio-code-for-writing-qt-applications。

